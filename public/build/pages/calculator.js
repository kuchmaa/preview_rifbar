import{S as Ce,A as Se}from"../chunks/slider.js";import{g as i,s as W,c as Z}from"../chunks/DOM.js";import{i as K,p as ae,a as ee,b as ce,c as R,V as J}from"../chunks/event.js";let X={},re={},V={};(()=>{var b=new Intl.NumberFormat("en-EN");window.amountFormatter=b,new Ce(i("affordableSlider")),new Se(i("mattressesAccordion"));var S=e=>(n,u,t)=>{const o=n*u*t*e;return Math.max(60,o).toFixed(2)},F=(e,n)=>{var u=150,t=0;return{setPrice(o){t=o(parseFloat(`${t}`.replaceAll(",","").replaceAll("$",""))),e.innerHTML=n(t<u?u:t),window.saveCalculatorData&&(window.currentOrderPrice=t<u?u:t,setTimeout(window.saveCalculatorData,0))},getPrice:()=>parseFloat(t.replaceAll(",",""))}};V=F(i("orderPrise"),e=>{var n=parseFloat(e).toFixed(2);return b.format(`${n}`)+" $"});var q=i("orderBtn");X={boxes:i("boxes"),furniture:i("furniture"),van:i("van"),mattresses:i("mattresses"),doors:i("doors"),tv:i("tv"),suitcases:i("suitcases")},re={boxes:i("boxesBtn"),furniture:i("furnitureBtn"),van:i("vanBtn"),mattresses:i("mattressesBtn"),doors:i("doorsBtn"),tv:i("tvBtn"),suitcases:i("suitcasesBtn")};var k={boxes:i("customBoxesList"),furniture:i("furnitureList"),mattresses:i("customMattressesList")},E={boxes:{open:i("custom-box-btn"),inputs:i("custom-box"),add:i("addCustomBoxSize")},furniture:{open:i("showFurnitureCustom"),inputs:i("furnitureCustomSize"),add:i("addCustomFurniture")},mattresses:{open:i("showCustomMattresses"),inputs:i("mattressesCustomInputs"),add:i("addCustomMattressesSize")}},g={boxes:{parent:i("boxCustomValues"),width:K(i("customBoxesWidth")),height:K(i("customBoxesHeigh")),length:K(i("customBoxesLength"))},furniture:{parent:i("furnitureCustomValues"),width:K(i("customFurnitureWidth")),height:K(i("customFurnitureHeigh")),length:K(i("customFurnitureLength"))},mattresses:{parent:i("mattressesCustomInputs"),width:K(i("customMattressesWidth")),height:K(i("customMattressesHeight")),length:K(i("customMattressesLength"))}},C=i("phone"),d=ve(X.boxes,re.boxes),l={};(()=>{for(const e in X){X[e].addEventListener("submit",ae()),d(re[e],X[e]);const n=X[e].getElementsByClassName("box");Array.from(n).forEach(u=>{u.getElementsByClassName("box-tab-count")[0].classList.add("disabled")}),l[e]=me(re[e],n)}})();const m=de({maxValue:400,minValue:0});var a={width:m(g.boxes.width,e=>`${e}"`),height:m(g.boxes.height,e=>`${e}"`),length:m(g.boxes.length,e=>`${e}"`)},p={width:m(g.furniture.width,e=>`${e}"`),height:m(g.furniture.height,e=>`${e}"`),length:m(g.furniture.length,e=>`${e}"`)},f={width:m(g.mattresses.width,e=>`${e}"`),height:m(g.mattresses.height,e=>`${e}"`),length:m(g.mattresses.length,e=>`${e}"`)};window.customSizeList=k,window.checkboxEvents=l,E.boxes.open.addEventListener("click",()=>{W(E.boxes.open,E.boxes.inputs)("active")}),E.boxes.add.addEventListener("click",()=>{if(!a.height.handler.getError()&&!a.width.handler.getError()&&!a.length.handler.getError()){var e=E.boxes;const u=W(e.inputs,e.open),t=S(.012),o=parseInt(a.width.handler.getValue()),s=parseInt(a.height.handler.getValue()),r=parseInt(a.length.handler.getValue()),c=t(o,s,r),h=se("box");var n=ne(k.boxes,{width:o,price:c,height:s,length:r,boxKey:h,checked:!0});window.customItems.boxes.push({key:h,width:o,height:s,length:r,price:c,count:1}),l.boxes.addCheckbox(k.boxes,n),window.saveCalculatorData&&setTimeout(window.saveCalculatorData,0),u("active")}}),E.furniture.add.addEventListener("click",()=>{if(p.height.handler.getState()&&p.width.handler.getState()&&p.length.handler.getState()){var e=E.furniture;const u=W(e.inputs,e.open),t=S(.012),o=parseInt(p.width.handler.getValue()),s=parseInt(p.height.handler.getValue()),r=parseInt(p.length.handler.getValue()),c=t(o,s,r),h=se("furniture");var n=ne(k.furniture,{width:o,price:c,height:s,length:r,boxKey:h,checked:!0});window.customItems.furniture.push({key:h,width:o,height:s,length:r,price:c,count:1}),l.furniture.addCheckbox(k.furniture,n),window.saveCalculatorData&&setTimeout(window.saveCalculatorData,0),u("active")}}),E.furniture.open.addEventListener("click",()=>{var e=E.furniture;W(e.open,e.inputs)("active")});var v=i("mattressesTable");E.mattresses.open.addEventListener("click",()=>{var e=E.mattresses;const n=W(e.open.parentElement,e.inputs);v.setAttribute("hidden",""),n("active")}),E.mattresses.add.addEventListener("click",()=>{var e=E.mattresses;const n=W(e.inputs,e.open.parentElement);if(!f.width.handler.getError()&&!f.height.handler.getError()&&!f.length.handler.getError()){k.mattresses.getAttribute("hidden")==""&&k.mattresses.removeAttribute("hidden"),k.mattresses.setAttribute("active","");var u=k.mattresses.getElementsByClassName("box-list")[0];const o=S(.012),s=parseInt(f.width.handler.getValue()),r=parseInt(f.height.handler.getValue()),c=parseInt(f.length.handler.getValue()),h=o(s,r,c),I=se("mattress");var t=ne(u,{boxKeyElement:!1,price:h,height:r,width:s,length:c,boxKey:I,checked:!0});window.customItems.mattresses.push({key:I,width:s,height:r,length:c,price:h,count:1}),l.mattresses.addCheckbox(u,t),window.saveCalculatorData&&setTimeout(window.saveCalculatorData,0),v.removeAttribute("hidden"),n("active")}}),ee(i("name"),{callback:(e,n)=>R({type:J.default,value:n})?n:e,errorCallback:e=>{}}),ce({wrapper:C,input:C.getElementsByTagName("input")[0],callback:(e,n)=>(e=e.replaceAll(" ",""),n=n.replaceAll(" ",""),isNaN(n)?e.replace(/^(\d{3})(\d{3})(\d{4})(.*)$/,"$1 $2 $3$4"):n.replace(/^(\d{3})(\d{3})(\d{4})(.*)$/,"$1 $2 $3$4")),errorMessage:e=>!R({type:J.phone,value:e.replaceAll(" ","")})}),ee(i("emailInputWrapper"),{callback:(e,n)=>n,errorCallback:e=>!R({type:J.email,value:e})&&"Invalid mail. Example: test.set_wqee@example.test.te"}),ee(i("upAddress"),L()),ee(i("upZipCode"),T()),ee(i("deliverAddress"),L()),ee(i("deliverZipCode"),T()),i("upState").addEventListener("change",y),i("deliverState").addEventListener("change",y);function y(e){e.target.parentElement.removeAttribute("error")}function L(){return{callback:(e,n)=>R({type:J.default,value:n})?n:e,errorCallback:e=>{if(e.length===0)return"Invalid address"}}}function T(){return{callback:(e,n)=>isNaN(n)||n.length>5?e:n,errorCallback:e=>{if(e.length!=5)return"Length: 5"}}}const w=document.getElementById("noProhibitedItems"),D=document.getElementById("confirmRules");function B(e){console.log(w),this.checked&&(D.removeAttribute("error"),w.removeEventListener("change",B))}q.addEventListener("click",async e=>{if(w&&!w.checked){e.preventDefault(),e.stopPropagation(),D.setAttribute("error",""),w.scrollIntoView({behavior:"smooth",block:"center"}),w.addEventListener("change",B);return}else if(w&&w.checked){D.removeAttribute("error");const t=document.getElementById("orderFrom");if(t){let o=t.querySelector('input[name="prohibited_items_confirmed_at"]');o||(o=document.createElement("input"),o.type="hidden",o.name="prohibited_items_confirmed_at",t.appendChild(o)),o.value=new Date().toISOString()}}if(e.preventDefault(),!O())return;q.disabled=!0;const u=q.innerHTML;q.innerHTML="<span>Processing...</span>";try{const t=U();if(console.log("Form data collected:",t),t.payment_method==="stripe"){if(typeof Stripe>"u")throw new Error("Stripe payment system is not available.");const s=await G(t);if(s)await le(s);else throw new Error("Failed to get Stripe session ID")}else{const s=await ue(t);if(s.success)window.location.href=s.redirect_url||"/cabinet";else throw new Error(s.message||"Failed to create order")}}catch(t){console.error("Error processing payment:",t);const o=document.getElementById("payment-error");o&&o.remove();let s="Payment processing error: "+t.message;(t.message.includes("validation")||t.message.includes("pattern"))&&(s="Please check all form fields are filled correctly. "+t.message);const r=Z("div",{id:"payment-error",className:"alert alert-danger",style:{color:"red",margin:"10px 0",padding:"10px",borderRadius:"5px",backgroundColor:"#f8d7da",border:"1px solid #f5c6cb"}},null,s)(),c=i("calc");c&&(c.insertBefore(r,c.firstChild),r.scrollIntoView({behavior:"smooth",block:"center"})),q.disabled=!1,q.innerHTML=u}});function O(){let e=!0;if(["name","email","phone","upZipCode","deliverZipCode","upCity","deliverCity","upAddress","deliverAddress"].forEach(t=>{const o=document.querySelector(`input[name="${t}"]`)??document.querySelector(`select[name="${t}"]`);if(!o){console.error(`Required field "${t}" not found in form`),e=!1;return}const s=o.closest(".inputWrapper")?o.closest(".inputWrapper").parentElement:o.parentElement.parentElement;if(!o.value.trim()){e=!1,s.setAttribute("error","");const r=s.querySelector(".error-message");r&&(r.innerText="This field is required")}if(t==="email"&&o.value.trim()&&!R({type:J.email,value:o.value})){e=!1,s.setAttribute("error","");const c=s.querySelector(".error-message");c&&(c.innerText="Please enter a valid email address")}if(t==="phone"&&o.value.trim()&&!/^\d{3}\s\d{3}\s\d{4}$/.test(o.value)){e=!1,s.setAttribute("error","");const h=s.querySelector(".error-message");h&&(h.innerText="Please enter a valid phone number")}if((t==="upZipCode"||t==="deliverZipCode")&&o.value.trim()&&(o.value.length!==5||isNaN(o.value))){e=!1,s.setAttribute("error","");const r=s.querySelector(".error-message");r&&(r.innerText="ZIP code must be 5 digits")}if((t==="upAddress"||t==="deliverAddress")&&o.value.trim()&&(o.value.length<5||!R({type:J.default,value:o.value}))){e=!1,s.setAttribute("error","");const r=s.querySelector(".error-message");r&&(r.innerText="Invalid address")}if((t==="upCity"||t==="deliverCity")&&o.value.trim()&&(o.value.length<2||!R({type:J.default,value:o.value}))){e=!1,s.setAttribute("error","");const r=s.querySelector(".error-message");r&&(r.innerText="Invalid city name")}}),!(document.querySelectorAll('input[type="checkbox"]:checked').length>0)){e=!1;const t=Z("div",{id:"items-error",className:"alert alert-danger",style:{color:"red",margin:"10px 0"}},null,"Please select at least one item for shipping")(),o=i("calc");if(o){const s=o.querySelector("#items-error");s&&s.remove(),o.insertBefore(t,o.firstChild),t.scrollIntoView({behavior:"smooth",block:"center"})}}return e}function U(){var h,I,A,$,x,P,_,Y,N,M,j;const e={name:((h=document.querySelector('input[name="name"]'))==null?void 0:h.value)||"",upAddress:((I=document.querySelector('input[name="upAddress"]'))==null?void 0:I.value)||"",deliverAddress:((A=document.querySelector('input[name="deliverAddress"]'))==null?void 0:A.value)||"",phone:((($=document.querySelector('input[name="phone"]'))==null?void 0:$.value)||"").replace(/\s/g,""),upZipCode:((x=document.querySelector('input[name="upZipCode"]'))==null?void 0:x.value)||"",deliverZipCode:((P=document.querySelector('input[name="deliverZipCode"]'))==null?void 0:P.value)||"",email:((_=document.querySelector('input[name="email"]'))==null?void 0:_.value)||"",upCity:((Y=document.querySelector('select[name="upCity"]'))==null?void 0:Y.value)||((N=document.querySelector('input[name="upCity"]'))==null?void 0:N.value)||"",deliverCity:((M=document.querySelector('select[name="deliverCity"]'))==null?void 0:M.value)||((j=document.querySelector('input[name="deliverCity"]'))==null?void 0:j.value)||"",insurance:0},n=te();["boxes","furniture","van","mattresses","doors","tv","suitcases"].forEach(H=>{e[H]=n[H]||[]});const t=document.querySelector('input[name="totalAmount"]');e.totalAmount=t?parseFloat(t.value):0;const o=document.getElementById("noProhibitedItems");if(o?o.checked:!1){e.no_prohibited_items_confirmed=!0;const H=document.querySelector('input[name="prohibited_items_confirmed_at"]');e.prohibited_items_confirmed_at=H?H.value:new Date().toISOString()}const r=document.querySelector('input[name="payment_method"]:checked');e.payment_method=r?r.value:"stripe";const c=document.querySelector('meta[name="csrf-token"]');return e._token=c?c.getAttribute("content"):"",e}function te(){let e={};return window.getFormData&&typeof window.getFormData=="function"?e=window.getFormData():e={boxes:z("boxes"),furniture:z("furniture"),van:z("van"),mattresses:z("mattresses"),doors:z("doors"),tv:z("tv"),suitcases:z("suitcases")},window.customItems&&["boxes","furniture","mattresses"].forEach(n=>{e[n]&&e[n].length>0&&window.customItems[n]&&(e[n]=e[n].map(u=>{if(u.key&&u.key.includes("custom_")){const t=window.customItems[n].find(o=>o.key===u.key);if(t)return{...u,size:{width:t.width||0,height:t.height||0,length:t.length||0}}}return u}))}),e}async function G(e){var s;const n=JSON.stringify(e),u=((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||"",t=await fetch("/stripe/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":u},body:n});if(!t.ok){if(t.status===401)return window.location.href="/login",null;let r="Server error: "+t.status;try{const c=await t.json();if(c.errors&&typeof c.errors=="object"){const h=[];for(const[I,A]of Object.entries(c.errors))Array.isArray(A)?h.push(...A):h.push(A);r=h.join(". ")}else r=c.error||c.message||r}catch{try{r=await t.text()||r}catch{r="Server error: "+t.status}}throw new Error(r)}const o=await t.json();if(!o.id)throw new Error("Stripe session ID not received from server");return o.id}async function ue(e){var s;console.log("Creating order directly with data:",e);const n=JSON.stringify(e),u=((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||"",t=await fetch("/orders",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":u,Accept:"application/json"},body:n});if(!t.ok){if(t.status===401)return window.location.href="/login",{success:!1,message:"Authentication required"};let r="Server error: "+t.status;try{const c=await t.json();if(c.errors&&typeof c.errors=="object"){const h=[];for(const[I,A]of Object.entries(c.errors))Array.isArray(A)?h.push(...A):h.push(A);r=h.join(". ")}else r=c.error||c.message||r}catch{try{r=await t.text()||r}catch{r="Server error: "+t.status}}return{success:!1,message:r}}return await t.json()}async function le(e){const n=document.querySelector('meta[name="stripeKey"]'),u=n?n.getAttribute("content"):"";if(!u)throw new Error("Stripe key not found");const t=Stripe(u);localStorage.removeItem("calculatorFormData");const{error:o}=await t.redirectToCheckout({sessionId:e});if(o)throw new Error(o.message)}window.insuranceCost=function(e){};function Q(){var I;const e=((I=document.querySelector('input[name="payment_method"]:checked'))==null?void 0:I.value)||"stripe",n=i("orderPrise"),u=i("stripeFeeRow"),t=i("stripeCommission"),o=i("totalWithCommission");if(!n||!o)return;const s=n.innerText.replace(/[^0-9.]/g,""),r=parseFloat(s)||0;let c=r;if(e==="stripe"){u&&(u.style.display="flex");const A=Math.round(r*.03*100)/100;t&&(t.innerHTML=`${A.toFixed(2)} $`),c=r+A}else u&&(u.style.display="none"),c=r;o.innerHTML=`${c.toFixed(2)} $`;const h=document.querySelector('input[name="totalAmount"]');h&&(h.value=c.toFixed(2))}const ie=i("orderPrise");if(!ie)return;Q(),new MutationObserver(Q).observe(ie,{childList:!0,characterData:!0,subtree:!0}),document.querySelectorAll('input[type="checkbox"]').forEach(e=>{e.addEventListener("change",Q)}),document.querySelectorAll(".box-tab-count input").forEach(e=>{e.addEventListener("change",Q),e.addEventListener("input",Q)}),document.querySelectorAll('input[name="payment_method"]').forEach(e=>{e.addEventListener("change",Q)});function de({maxValue:e,minValue:n}){return(u,t)=>{var o=ce({wrapper:u.errorElem.parentElement,input:u.input,errorElem:u.errorElem,callback:(s,r,c)=>(r=r.replace('"',""),c.inputType=="deleteContentBackward"&&(r=r.slice(0,-1)),R({type:J.number,value:r})?`${r}"`:s),errorMessage:s=>{if(s=s.slice(0,-1),s>e||s<n)return`min: ${n} - max: ${e}`}});return{maxValue:e,handler:o,minValue:n}}}function me(e,n){var u=!1,t=Array.from({length:n.length},()=>!1);return n.length>0&&Array.from(n).forEach((c,h)=>{s(c,h,!1,!0)}),{addCheckbox:(c,h)=>{t.push(!0);const I=s(h,t.length-1,h.getElementsByClassName("checkbox")[0].checked,!0),A=h.getElementsByClassName("box-tab-delete")[0];A.onclick=()=>{const $=Array.from(c.children),x=h.getAttribute("data-key");if(x&&x.includes("custom_")){let P=null;c.id==="customBoxesList"?P="boxes":c.id==="furnitureList"?P="furniture":c.closest("#customMattressesList")&&(P="mattresses"),P&&window.customItems&&window.customItems[P]&&(window.customItems[P]=window.customItems[P].filter(_=>_.key!==x),window.saveCalculatorData&&setTimeout(window.saveCalculatorData,0))}$.filter(P=>P==h&&o(c,I))},r()},removeCheckbox:o,length:()=>t.length};function o(c,h){const I=Array.from(c.children);for(var A=0;A<I.length;++A)if(I[A]==h.element){var $=t.length-I.length-1;t=t.filter((x,P)=>P-1!=$+A),c.removeChild(h.element);break}if(h.checkbox.checked()&&V.setPrice(x=>x-h.checkbox.getPrice()*h.counter.getValue()),r(),window.saveCalculatorData&&setTimeout(window.saveCalculatorData,0),l.furniture.length()==0){const x=E.furniture;W(x.open,x.inputs)("active")}}function s(c,h,I,A=!1){var $=fe(c.getElementsByClassName("box-tab-count")[0],(P,_)=>{var Y=c.getElementsByClassName("box-size-value-prise")[0].getElementsByTagName("strong")[0];console.log(x.basePrise),Number(_)<=0&&x.checked()?x.setChecked(!1):Number(_)>0&&!x.checked()&&x.setChecked(!0),Y.innerText=`$${window.amountFormatter.format(x.getPrice()*_)}`,x.checked()&&V.setPrice(M=>M-x.getPrice()*P+x.getPrice()*_);const N=c.getAttribute("data-key");N&&window.customItems&&["boxes","furniture","mattresses"].forEach(M=>{if(window.customItems[M]){const j=window.customItems[M].findIndex(H=>H.key===N);j!==-1&&(window.customItems[M][j].count=parseInt(_),window.saveCalculatorData&&setTimeout(window.saveCalculatorData,0))}})});A&&$.enable();var x=pe(c,I,P=>{P?V.setPrice(_=>_+x.getPrice()*$.getValue()):V.setPrice(_=>_-x.getPrice()*$.getValue()),t[h]=x.checked(),r()});return I&&V.setPrice(P=>P+x.getPrice()),{element:c,checkbox:x,counter:$}}function r(){u=t.some(Boolean),!e.getAttribute("checked")&&u?e.setAttribute("checked",""):u||e.removeAttribute("checked")}}function pe(e,n=!1,u){var t=e.getElementsByClassName("box-size-value-prise")[0].getElementsByTagName("strong")[0].innerHTML.split("$")[1];const o=Number(t);var s=e.getElementsByTagName("input")[0];const r=new Event("change",{bubbles:!0});return s.addEventListener("change",()=>{n=!n,u(n)}),{basePrise:o,getPrice:()=>parseFloat(t.replaceAll(",","")),checked:()=>n,setChecked:()=>{s.checked=!s.checked,s.dispatchEvent(r)}}}function fe(e,n){var u=!1;let t=1;const o={minus:e.getElementsByTagName("svg")[0],add:e.getElementsByTagName("svg")[1]};var s=e.getElementsByTagName("input")[0];return o.minus.addEventListener("click",()=>{if(u){var r=s.value;t=Number(r),r>0&&--r,r==""&&(r=0),n(t,r),s.value=r}}),o.add.addEventListener("click",()=>{if(u){var r=s.value;t=Number(r),++r,n(t,r),s.value=r}}),s.addEventListener("keydown",ae(()=>{})),{enable:()=>{u=!0,e.classList.remove("disabled")},disable:()=>{u=!1},parent:e,getValue:()=>parseInt(s.value)}}function ne(e,{boxKeyElement:n,price:u,width:t,height:o,length:s,boxKey:r,checked:c=!1}){var h=e.children.length,I=he({key:h+1,price:u,boxKeyElement:n,width:t,height:o,length:s,boxKey:r,checked:c});return e.append(I),I}window.addItemToCustomSize=ne;function he({key:e,boxKeyElement:n=!0,price:u,width:t,height:o,length:s,boxKey:r,checked:c}){const h=Z("div",{},["box","size-row","flex","row","aic","delateBoxWrapper"]),I=Z("input",{type:"checkbox",name:r||`custom${e}`,checked:c},["checkbox"])();if(n)var r=Z("h3",{},["box-size","flex","row","aic","color-blue"],`<strong>C${e}</strong>`);const A=x(n&&r(),P({width:t,height:o,price:u,length:s})),$=h(I,A,_(),Y());return r?$.setAttribute("data-key",r):$.setAttribute("data-key",`custom${e}`),$;function x(...N){return N=N.filter(M=>N&&M),Z("div",{},["box-size-wrapper","flex","row"])(...N)}function P({width:N,height:M,length:j,price:H}){var ge=Z("div",{},["box-size-values","flex","col"]),ye=(()=>{var oe="";return N&&(oe+=`${N}"x`),M&&(oe+=`${M}"x`),j&&(oe+=`${j}"`),oe})();const be=Z("span",{},["box-size-value-param","flex","col"])(ye),we=Z("strong",{},["box-size-value-prise"],`<span><strong>$${window.amountFormatter.format(H)}</strong></span>`)(),xe=Z("span",{style:{display:"none"}},["basePriceValue"],H)();return ge(be,we,xe)}function _(){return Z("div",{},["box-tab-count","flex","row"],`<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
			<path d="M19 15L9 15L9 13L19 13V15Z" fill="black" />
		</svg>
		<input type="number" value="1" min="1">
		<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
			<path d="M19 15V13H15L15 9H13L13 13H9V15L13 15L13 19H15L15 15L19 15Z" fill="black" />
		</svg>`)()}function Y(){return Z("div",{},["box-tab-delete","flex-center"])()}}function ve(e,n){return(u,t)=>{u.addEventListener("click",()=>{var o=W(e,t),s=W(n,u);t!=e&&(e=t,n=u,o("active"),s("active"))})}}})();window.getCalculatedPrice=function(){return V.getPrice()};window.getFormData=function(){return{boxes:z("boxes"),furniture:z("furniture"),van:z("van"),mattresses:z("mattresses"),doors:z("doors"),tv:z("tv"),suitcases:z("suitcases")}};window.form=X;window.calcPages=re;function z(b){const S=[];try{const F=i(b);if(!F)return S;F.querySelectorAll('input[type="checkbox"]:checked').forEach((k,E)=>{try{const g=k.closest(".size-row")||k.closest(".box");if(!g)return;const C=k.getAttribute("name")||"",d=g.querySelector('input[type="number"]'),l=d&&parseInt(d.value)||1;let m=0,a=0,p=0;if(C.includes("custom")||b==="furniture"){const L=g.querySelector('input[placeholder*="width"], input[name*="width"]'),T=g.querySelector('input[placeholder*="height"], input[name*="height"]'),w=g.querySelector('input[placeholder*="length"], input[name*="length"]');L&&(m=parseFloat(L.value.replace(/[^0-9.]/g,""))||0),T&&(a=parseFloat(T.value.replace(/[^0-9.]/g,""))||0),w&&(p=parseFloat(w.value.replace(/[^0-9.]/g,""))||0)}let f=0;const v=g.querySelector(".box-size-value-prise");if(v){const L=v.textContent;f=parseFloat(L.replace(/[^\d.]/g,""))}const y={key:C,count:l,size:{width:m,height:a,length:p},price:f};S.push(y)}catch{}})}catch{}return S}document.addEventListener("DOMContentLoaded",function(){setTimeout(window.initCalculatorAutocomplete,1e3),F(),k(),window.saveCalculatorData=b;function b(){var g,C,d,l,m,a,p,f,v,y,L,T,w,D,B;try{const O=localStorage.getItem("cookieConsent");if(O&&!JSON.parse(O).functional)return;const U={boxes:S("boxes"),furniture:S("furniture"),mattresses:S("mattresses"),van:S("van"),doors:S("doors"),tv:S("tv"),suitcases:S("suitcases"),user_info:{name:((g=document.querySelector("#name input"))==null?void 0:g.value)||"",email:((C=document.querySelector("#emailInputWrapper input"))==null?void 0:C.value)||"",phone:((d=document.querySelector("#phone input"))==null?void 0:d.value)||"",upAddress:((l=document.querySelector("#upAddress input"))==null?void 0:l.value)||"",deliverAddress:((m=document.querySelector("#deliverAddress input"))==null?void 0:m.value)||"",zipCode:((a=document.querySelector("#zipCodeWrapper input"))==null?void 0:a.value)||"",city:((p=document.querySelector("#cityInputWrapper input"))==null?void 0:p.value)||"",upZipCode:((f=document.querySelector('input[name="upZipCode"]'))==null?void 0:f.value)||"",deliverZipCode:((v=document.querySelector('input[name="deliverZipCode"]'))==null?void 0:v.value)||"",upCity:((y=document.querySelector('select[name="upCity"]'))==null?void 0:y.value)||((L=document.querySelector('input[name="upCity"]'))==null?void 0:L.value)||"",deliverCity:((T=document.querySelector('select[name="deliverCity"]'))==null?void 0:T.value)||((w=document.querySelector('input[name="deliverCity"]'))==null?void 0:w.value)||"",insurance:{checked:!0,value:((D=document.querySelector("#insuranceWrapper input"))==null?void 0:D.value)||"0",cost:((B=i("cost"))==null?void 0:B.innerText)||"$25"}},orderPrice:window.currentOrderPrice||V.getPrice(),timestamp:Date.now(),expiresIn:24*60*60*1e3};localStorage.setItem("calculatorFormData",JSON.stringify(U)),typeof Cookies<"u"&&typeof Cookies.set=="function"&&Cookies.set("calculatorFormData",JSON.stringify(U),{expires:1})}catch{}}function S(g){const C=[],d=window.form[g];return d&&d.querySelectorAll('input[type="checkbox"]').forEach(m=>{var T;const a=m.closest(".size-row")||m.closest(".box");if(!a)return;const p=a.querySelector('input[type="number"]');if(!p)return;const f=m.getAttribute("name"),v=m.checked,y=p.value,L={name:f,checked:v,count:y};if(f&&f.startsWith("custom_")){a.getAttribute("data-key");let w=0,D=0,B=0,O=0;const U=(T=a.querySelector(".box-size-value-param"))==null?void 0:T.textContent;if(U){const G=U.split("x");G.length>=3&&(w=parseInt(G[0])||0,D=parseInt(G[1])||0,B=parseInt(G[2])||0)}const te=a.querySelector(".basePriceValue");te&&(O=parseFloat(te.textContent.replace(/[^\d.]/g,""))||0,y>1&&(O=O/y)),L.size={width:w,height:D,length:B},L.price=O}C.push(L)}),C}function F(){try{const g=localStorage.getItem("cookieConsent");if(g&&!JSON.parse(g).functional)return;let C=localStorage.getItem("calculatorFormData");if(!C&&typeof Cookies<"u"&&typeof Cookies.get=="function"&&(C=Cookies.get("calculatorFormData")),C){const d=JSON.parse(C);if(d.timestamp&&d.expiresIn){const l=Date.now(),m=d.timestamp+d.expiresIn;if(l>m){localStorage.removeItem("calculatorFormData"),typeof Cookies<"u"&&typeof Cookies.remove=="function"&&Cookies.remove("calculatorFormData");return}}if(d.boxes&&q("boxes",d.boxes),d.furniture&&q("furniture",d.furniture),d.mattresses&&q("mattresses",d.mattresses),d.van&&q("van",d.van),d.doors&&q("doors",d.doors),d.tv&&q("tv",d.tv),d.suitcases&&q("suitcases",d.suitcases),d.user_info){const l=d.user_info;if(l.name&&(document.querySelector("#name input").value=l.name),l.email&&(document.querySelector("#emailInputWrapper input").value=l.email),l.phone&&(document.querySelector("#phone input").value=l.phone),l.upAddress&&(document.querySelector("#upAddress input").value=l.upAddress),l.deliverAddress&&(document.querySelector("#deliverAddress input").value=l.deliverAddress),l.upZipCode){const a=document.querySelector('input[name="upZipCode"]');a&&(a.value=l.upZipCode)}if(l.deliverZipCode){const a=document.querySelector('input[name="deliverZipCode"]');a&&(a.value=l.deliverZipCode)}if(l.upCity){const a=document.querySelector('select[name="upCity"]');a&&Array.from(a.options).find(y=>y.value===l.upCity)&&(a.value=l.upCity);const p=document.querySelector('input[name="upCity"]');p&&(p.value=l.upCity)}if(l.deliverCity){const a=document.querySelector('select[name="deliverCity"]');a&&Array.from(a.options).find(y=>y.value===l.deliverCity)&&(a.value=l.deliverCity);const p=document.querySelector('input[name="deliverCity"]');p&&(p.value=l.deliverCity)}if(l.zipCode){const a=document.querySelector("#zipCodeWrapper input");a&&(a.value=l.zipCode)}if(l.city){const a=document.querySelector("#cityInputWrapper input");a&&(a.value=l.city)}["name","upAddress","deliverAddress","email","zipCode","upZipCode","deliverZipCode"].forEach(a=>{const p=document.querySelector(`#${a==="email"?"emailInputWrapper":a} input`)||document.querySelector(`input[name="${a}"]`);if(p&&p.value){const f=p.parentElement.querySelector(".placeholder");f&&f.removeAttribute("hidden")}})}if(d.orderPrice){window.currentOrderPrice=d.orderPrice,console.log(d.orderPrice),V.setPrice(()=>d.orderPrice);const l=i("orderPrise");l&&(l.innerHTML=amountFormatter.format(d.orderPrice)+" $")}else E()}}catch{}}function q(g,C){const d=window.form[g];if(!d)return;C.forEach(m=>{if(m.name)if(m.name.startsWith("custom_"))l(g,m);else{const a=d.querySelector(`input[name="${m.name}"]`);if(!a)return;if(m.checked){a.checked=!0;const p=a.closest(".size-row")||a.closest(".box");if(p){const f=p.querySelector('input[type="number"]');f&&m.count&&(f.value=m.count);const v=p.querySelector(".box-tab-count");v&&v.classList.remove("disabled"),a.dispatchEvent(new Event("change",{bubbles:!0}))}}}});function l(m,a){const p=a.size||{},f=parseInt(a.count)||1,v=a.name;if(!p.width||!p.height||!p.length)return;let y,L=!0;switch(m){case"boxes":y=customSizeList.boxes;break;case"furniture":y=customSizeList.furniture;break;case"mattresses":y=customSizeList.mattresses,y.getAttribute("hidden")===""&&y.removeAttribute("hidden"),y.setAttribute("active",""),y=y.getElementsByClassName("box-list")[0]||y,L=!1,mattressesTable&&mattressesTable.hasAttribute("hidden")&&mattressesTable.removeAttribute("hidden");break;default:return}const T=addItemToCustomSize(y,{width:p.width,height:p.height,length:p.length,price:a.price||0,boxKey:v,boxKeyElement:L,checked:a.checked});if(window.customItems[m].push({key:v,width:p.width,height:p.height,length:p.length,price:a.price||0,count:f}),checkboxEvents[m].addCheckbox(y,T),f>1){const w=T.querySelector('input[type="number"]');if(w){w.value=f;const D=T.querySelector(".box-tab-count");D&&D.classList.remove("disabled");const B=T.querySelector(".box-size-value-prise strong");B&&a.price&&(B.innerText=`$${window.amountFormatter.format(a.price*f)}`)}}}}function k(){document.querySelectorAll("#inputs input, #inputs select").forEach(v=>{v.addEventListener("change",()=>setTimeout(b,0)),v.addEventListener("input",()=>setTimeout(b,0))}),document.querySelectorAll('select[name="upCity"], select[name="deliverCity"]').forEach(v=>{v.addEventListener("change",()=>setTimeout(b,0))}),document.querySelectorAll('input[type="checkbox"]').forEach(v=>{v.addEventListener("change",()=>setTimeout(b,0))}),document.querySelectorAll(".box-tab-count input").forEach(v=>{v.addEventListener("change",function(){f(this),setTimeout(b,0)}),v.addEventListener("input",function(){f(this),setTimeout(b,0)})}),document.querySelectorAll(".box-tab-count svg").forEach(v=>{v.addEventListener("click",function(){const y=v.parentElement.querySelector('input[type="number"]');setTimeout(y?()=>{f(y),b()}:b,100)})}),document.querySelectorAll(".checkBox").forEach(v=>{v.addEventListener("click",function(){setTimeout(b,100)})});const p=i("orderBtn");p&&p.addEventListener("click",()=>setTimeout(b,0));function f(v){const y=v.closest(".box");if(!y)return;const L=y.getAttribute("data-key");if(!L||!window.customItems)return;const T=parseInt(v.value)||1;["boxes","furniture","mattresses"].forEach(w=>{if(window.customItems[w]){const D=window.customItems[w].findIndex(B=>B.key===L);D!==-1&&(window.customItems[w][D].count=T)}})}}function E(){try{V.setPrice(()=>0),["boxes","furniture","mattresses","van","doors","tv","suitcases"].forEach(g=>{const C=i(g);if(!C)return;C.querySelectorAll('input[type="checkbox"]:checked').forEach(l=>{var L,T;const m=l.closest(".box")||l.closest(".size-row");if(!m)return;const a=m.querySelector(".box-size-value-prise strong");if(!a)return;const p=m.querySelector('input[type="number"]'),f=p&&parseInt(p.value)||1;let v=parseFloat(a.textContent.replace(/[^\d.]/g,""))||0;if(((L=l.getAttribute("name"))==null?void 0:L.startsWith("custom_"))&&f>1){const w=m.getAttribute("data-key");if(w){const D=(T=window.customItems[g])==null?void 0:T.find(B=>B.key===w);D&&(v=D.price*f)}}V.setPrice(w=>w+v)})})}catch{}}});window.clearCalculatorData=function(){const b=localStorage.getItem("cookieConsent");let S=!0;b&&(S=JSON.parse(b).functional),S&&(window.cookieUtils&&window.cookieUtils.deleteCookie("calculatorFormData"),localStorage.removeItem("calculatorFormData")),window.customItems={boxes:[],furniture:[],mattresses:[]};try{const F=i("customBoxesList"),q=i("furnitureList"),k=i("customMattressesList");if(F&&(F.innerHTML=""),q&&(q.innerHTML=""),k){const E=k.querySelector(".box-list");E?E.innerHTML="":k.innerHTML=""}}catch{}};window.customItems={boxes:[],furniture:[],mattresses:[]};function se(b){return`custom_${b}_${Date.now()}_${Math.floor(Math.random()*1e3)}`}window.currentOrderPrice=null;window.initCalculatorAutocomplete=function(){if(typeof google>"u"||!google.maps||!google.maps.places){setTimeout(window.initCalculatorAutocomplete,500);return}const b=document.querySelector('input[name="upAddress"]'),S=document.querySelector('input[name="deliverAddress"]'),F=document.querySelector('input[name="upZipCode"]'),q=document.querySelector('input[name="deliverZipCode"]'),k=document.getElementById("upState"),E=document.getElementById("deliverState"),g={types:["address"],componentRestrictions:{country:"us"},language:"en",region:"us"},C=(d,l)=>{const m={postal_code:"",state:"",state_short:""};for(const p of d.address_components){const f=p.types;f.includes("postal_code")&&(m.postal_code=p.long_name),f.includes("administrative_area_level_1")&&(m.state=p.long_name,m.state_short=p.short_name)}let a=d.formatted_address?d.formatted_address.replace(", USA",""):"";if(console.log(a),l){if(b&&(b.value=a,b.dispatchEvent(new Event("input",{bubbles:!0})),b.dispatchEvent(new Event("change",{bubbles:!0}))),F&&m.postal_code&&(F.value=m.postal_code,F.dispatchEvent(new Event("input",{bubbles:!0})),F.dispatchEvent(new Event("change",{bubbles:!0}))),k&&m.state){const p=Array.from(k.options).find(f=>f.value===m.state||f.text===m.state||f.value===m.state_short);p&&(k.value=p.value,k.dispatchEvent(new Event("change",{bubbles:!0})))}}else if(S&&(S.value=a,S.dispatchEvent(new Event("input",{bubbles:!0})),S.dispatchEvent(new Event("change",{bubbles:!0}))),q&&m.postal_code&&(q.value=m.postal_code,q.dispatchEvent(new Event("input",{bubbles:!0})),q.dispatchEvent(new Event("change",{bubbles:!0}))),E&&m.state){const p=Array.from(E.options).find(f=>f.value===m.state||f.text===m.state||f.value===m.state_short);p&&(E.value=p.value,E.dispatchEvent(new Event("change",{bubbles:!0})))}window.saveCalculatorData&&setTimeout(window.saveCalculatorData,100)};if(b)try{const d=new google.maps.places.Autocomplete(b,g);d.setFields(["address_components","formatted_address"]),d.addListener("place_changed",()=>{const l=d.getPlace();l.address_components&&C(l,!0)})}catch(d){console.warn("Не удалось инициализировать автозаполнение для pickup адреса:",d)}if(S)try{const d=new google.maps.places.Autocomplete(S,g);d.setFields(["address_components","formatted_address"]),d.addListener("place_changed",()=>{const l=d.getPlace();l.address_components&&C(l,!1)})}catch(d){console.warn("Не удалось инициализировать автозаполнение для delivery адреса:",d)}};
