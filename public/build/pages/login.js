import{g as t}from"../chunks/DOM.js";import{a as l,c as i,V as m,d as p,p as d}from"../chunks/event.js";(()=>{const e={errorElem:t("error"),element:t("form"),inputsWrapper:{email:t("email"),pass:t("pass")},buttons:{submit:t("submit")}},o=l(e.inputsWrapper.email,{callback:(r,a)=>a,errorCallback:r=>!i({type:m.email,value:r})&&"Invalid email"}),s=p(e.inputsWrapper.pass,null,{pass:e.inputsWrapper.pass.getElementsByClassName("showPass")[0]});e.element.addEventListener("submit",d(()=>{if(e.buttons.submit.disabled=!0,o.checkError()&&s.passHandler.checkError()){const r=new FormData(e.element);fetch("/login",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:r.get("email"),password:s.getPass(),remember:!!r.get("remember")})}).then(async a=>{if(!a.ok){let n={};try{n=await a.json()}catch{}throw new Error("Invalid email or password")}window.location.href="/dashboard"}).catch(a=>{e.buttons.submit.disabled=!1,e.errorElem.innerText=`${a.message}`,o.setError(!0),s.passHandler.setError(!0)})}}))})();
